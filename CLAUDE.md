# ë©”ë©˜í† ì• ë‹ˆ (Memento Ani) í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸

## í”„ë¡œì íŠ¸ ê°œìš”
ë°˜ë ¤ë™ë¬¼ê³¼ í•¨ê»˜í•˜ëŠ” ëª¨ë“  ìˆœê°„ì„ ê¸°ë¡í•˜ê³ , ì´ë³„ í›„ì—ë„ ë”°ëœ»í•œ ì¶”ì–µì„ ê°„ì§í•  ìˆ˜ ìˆëŠ” **ë©”ëª¨ë¦¬ì–¼ ì»¤ë®¤ë‹ˆí‹° í”Œë«í¼**

### í•µì‹¬ ì»¨ì…‰
- My Little Puppy ê²Œì„ ê°ì„± (ë°ê³  ë”°ëœ»í•œ íŒŒìŠ¤í…”í†¤)
- ë“€ì–¼ ëª¨ë“œ: ì¼ìƒ(active) â†” ì¶”ëª¨(memorial)
- ì§ì ‘ì  ì£½ìŒ/ì²œêµ­ ì–¸ê¸‰ ëŒ€ì‹  "ë¬´ì§€ê°œë‹¤ë¦¬" ê°™ì€ ì™„ê³¡í•œ í‘œí˜„

---

## ê¸°ìˆ  ìŠ¤íƒ

| ì˜ì—­ | ê¸°ìˆ  |
|-----|------|
| Frontend | Next.js 14 (App Router), TypeScript, Tailwind CSS |
| UI | Radix UI + shadcn/ui |
| Backend | Supabase (PostgreSQL, Auth, Storage) |
| AI | OpenAI GPT-4o-mini |
| ë°°í¬ | Vercel (ì˜ˆì •) |

---

## í”„ë¡œì íŠ¸ êµ¬ì¡°

```
src/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ page.tsx              # ë©”ì¸ ë¼ìš°í„° (íƒ­ ê¸°ë°˜ SPA)
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ chat/route.ts     # AI í«í†¡ API
â”‚   â”‚   â””â”€â”€ reminders/        # ë¦¬ë§ˆì¸ë” CRUD API
â”‚   â””â”€â”€ auth/callback/        # Supabase Auth ì½œë°±
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ pages/                # 8ê°œ ë©”ì¸ í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ common/               # Layout, Footer
â”‚   â”œâ”€â”€ features/             # ê¸°ëŠ¥ë³„ ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ modals/               # ëª¨ë‹¬ ì»´í¬ë„ŒíŠ¸
â”‚   â””â”€â”€ ui/                   # shadcn/ui ê¸°ë³¸ ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ contexts/
â”‚   â”œâ”€â”€ AuthContext.tsx       # ì¸ì¦ ìƒíƒœ ê´€ë¦¬
â”‚   â””â”€â”€ PetContext.tsx        # ë°˜ë ¤ë™ë¬¼ ë°ì´í„° ê´€ë¦¬
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ agent.ts              # AI ì—ì´ì „íŠ¸ ë¡œì§
â”‚   â”œâ”€â”€ supabase.ts           # Supabase í´ë¼ì´ì–¸íŠ¸ (í´ë¼ì´ì–¸íŠ¸ìš©)
â”‚   â”œâ”€â”€ supabase-server.ts    # Supabase ì„œë²„ í´ë¼ì´ì–¸íŠ¸ (APIìš©, ì„¸ì…˜ ì¸ì¦)
â”‚   â””â”€â”€ storage.ts            # ìŠ¤í† ë¦¬ì§€ ìœ í‹¸
â””â”€â”€ types/index.ts            # ëª¨ë“  íƒ€ì… ì •ì˜ (ì¤‘ì•™ ê´€ë¦¬)
```

---

## í•µì‹¬ ì»¨ë²¤ì…˜

### 1. íƒ€ì… ê´€ë¦¬
```typescript
// âœ… ì˜¬ë°”ë¥¸ ë°©ë²•: types/index.tsì—ì„œ import
import { Pet, PetPhoto, TabType } from "@/types";

// âŒ ì˜ëª»ëœ ë°©ë²•: ì»´í¬ë„ŒíŠ¸ì—ì„œ ìì²´ ì •ì˜
interface Pet { ... }  // ê¸ˆì§€!
```

### 2. ì»¬ëŸ¬ ì‹œìŠ¤í…œ
```
ì¼ìƒ ëª¨ë“œ: #05B2DC (í•˜ëŠ˜ìƒ‰), #E0F7FF (ì—°í•˜ëŠ˜), #38BDF8 (ë°ì€íŒŒë‘)
ì¶”ëª¨ ëª¨ë“œ: amber ê³„ì—´ (í™©ê¸ˆë¹›, ë”°ëœ»í•œ ëŠë‚Œ)
ë°°ê²½: ë­‰ê²Œêµ¬ë¦„ í™”ì´íŠ¸ ê·¸ë¼ë°ì´ì…˜
```

### 3. ì½”ë“œ ìŠ¤íƒ€ì¼
- ì´ëª¨ì§€ ì‚¬ìš© ê¸ˆì§€ (ì„œë¹„ìŠ¤ íŠ¹ì„±ìƒ)
- ì»´í¬ë„ŒíŠ¸ íŒŒì¼ ìƒë‹¨ì— JSDoc ì£¼ì„ìœ¼ë¡œ ì„¤ëª…
- API ì‘ë‹µì€ camelCaseë¡œ ë³€í™˜í•´ì„œ ì‚¬ìš©

---

## ì£¼ìš” í˜ì´ì§€ (8ê°œ íƒ­)

| íƒ­ | ì»´í¬ë„ŒíŠ¸ | ìƒíƒœ |
|---|---------|-----|
| í™ˆ | HomePage | âœ… ì™„ë£Œ |
| ìš°ë¦¬ì˜ ê¸°ë¡ | RecordPage | âœ… ì™„ë£Œ |
| ì»¤ë®¤ë‹ˆí‹° | CommunityPage | ğŸŸ¡ ëª©ì—… |
| AI í«í†¡ | AIChatPage | âœ… ì™„ë£Œ |
| ì…ì–‘ì •ë³´ | AdoptionPage | ğŸŸ¡ ëª©ì—… |
| ì§€ì—­ì •ë³´ | LocalPage | ğŸŸ¡ ëª©ì—… |
| ë¶„ì‹¤ë™ë¬¼ | LostPage | ğŸŸ¡ ëª©ì—… |
| í«ë§¤ê±°ì§„ | MagazinePage | ğŸŸ¡ ëª©ì—… |

---

## ë“€ì–¼ ëª¨ë“œ ì‹œìŠ¤í…œ

```typescript
// Pet ìƒíƒœì— ë”°ë¼ UI/ê¸°ëŠ¥ ë¶„ê¸°
if (selectedPet?.status === "memorial") {
    // ì¶”ëª¨ ëª¨ë“œ: í™©ê¸ˆë¹› í…Œë§ˆ, ì¹˜ìœ  ê²Œì‹œíŒ, AI ìœ„ë¡œ ìƒë‹´
} else {
    // ì¼ìƒ ëª¨ë“œ: í•˜ëŠ˜ìƒ‰ í…Œë§ˆ, ì¼€ì–´ ì•Œë¦¼, AI ì¼€ì–´ ë§¤ë‹ˆì €
}
```

---

## ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ (Supabase)

### í•µì‹¬ í…Œì´ë¸”
- `pets` - ë°˜ë ¤ë™ë¬¼ ì •ë³´
- `pet_media` - ì‚¬ì§„/ì˜ìƒ
- `timeline_entries` - íƒ€ì„ë¼ì¸ ì¼ê¸°
- `pet_reminders` - ì¼€ì–´ ì•Œë¦¼
- `chat_messages` - AI ëŒ€í™” ê¸°ë¡
- `pet_memories` - AI ì¥ê¸° ë©”ëª¨ë¦¬

### RLS ì •ì±…
ëª¨ë“  í…Œì´ë¸”ì— `auth.uid() = user_id` ì •ì±… ì ìš©

---

## í˜„ì¬ ìƒíƒœ ë° ìš°ì„ ìˆœìœ„

### ì™„ë£Œëœ ê¸°ëŠ¥ âœ…
- ë°˜ë ¤ë™ë¬¼ CRUD + ì‚¬ì§„/ì˜ìƒ ê´€ë¦¬
- AI í«í†¡ (ì¼ìƒ/ì¶”ëª¨ ëª¨ë“œ, ê°ì • ë¶„ì„)
- íƒ€ì„ë¼ì¸ ì¼ê¸° + í¸ì§‘
- ì¼€ì–´ ë¦¬ë§ˆì¸ë” ì‹œìŠ¤í…œ
- ë“€ì–¼ ëª¨ë“œ UI ì „í™˜
- ë™ë¬¼ë³„ ê²Œì‹œíŒ ë¶„ë¥˜
- **API ë³´ì•ˆ**: reminders API ì„¸ì…˜ ê¸°ë°˜ ì¸ì¦ ì™„ë£Œ (supabase-server.ts)
- **ê´€ë¦¬ì í˜ì´ì§€**: AdminPage.tsx (ì‚¬ìš©ì/ê²Œì‹œë¬¼ ê´€ë¦¬, ëŒ€ì‹œë³´ë“œ)
- **í”„ë¦¬ë¯¸ì—„ ëª¨ë‹¬**: PremiumModal.tsx (ì»¤í”¼ í•œ ì” ê°’ ì„¤ë“)
- **ë¡œê·¸ì¸ í”„ë¡¬í”„íŠ¸**: LoginPromptModal.tsx (ë¹„ë¡œê·¸ì¸ ìœ ì € ìœ ë„)
- **ëœë”© í˜ì´ì§€ ì œê±°**: ë¹„ë¡œê·¸ì¸ìë„ í™ˆ í™”ë©´ ë°”ë¡œ ì ‘ê·¼ ê°€ëŠ¥
- **isPremium DB ì—°ë™**: AuthContextì—ì„œ profiles.is_premium + premium_expires_at ì²´í¬
- **ì»¤ë®¤ë‹ˆí‹° DB ì—°ë™**: /api/posts CRUD, 5ê°œ ê²Œì‹œíŒ ë¶„ë¥˜, ì¢‹ì•„ìš”/ëŒ“ê¸€/ì‹ ê³ 
- **ì…ì–‘ì •ë³´ DB ì—°ë™**: /api/adoption ê³µê³µë°ì´í„° ì—°ë™ + í´ë°± ëª©ì—…
- **ë¶„ì‹¤ë™ë¬¼ DB ì—°ë™**: /api/lost-pets ì™„ì „ CRUD + ì´ë¯¸ì§€ ì—…ë¡œë“œ
- **í«ë§¤ê±°ì§„ DB ì—°ë™**: /api/magazine ê´€ë¦¬ì ì‘ì„± + ë³¸ë¬¸ ì´ë¯¸ì§€ ì‚½ì…
- **ì§€ì—­ì •ë³´ DB ì—°ë™**: /api/local-posts CRUD + ì§€ì—­ í•„í„°
- **ì ‘ê·¼ì„±**: ëª¨ë‹¬ 19ê°œ aria ì†ì„± (role, aria-modal, aria-labelledby)
- **ì»´í¬ë„ŒíŠ¸ ë¶„ë¦¬**: RecordPageì—ì„œ PetProfileCard, PetPhotoAlbum ì¶”ì¶œ
- **ê°œì¸í™”**: ì˜¨ë³´ë”© ë°ì´í„° ê¸°ë°˜ í™ˆí˜ì´ì§€ HERO ê°œì¸í™” (planning/current/memorial)
- **ë ˆë²¨ ì•„ì´ì½˜**: petTypeë³„ (dog/cat/other) 7ë‹¨ê³„ ì•„ì´ì½˜ ì‹œìŠ¤í…œ
- **API ì—”ë“œí¬ì¸íŠ¸ ìƒìˆ˜í™”**: src/config/apiEndpoints.ts

### ê°œì„  í•„ìš” ğŸ”§
1. **ê²°ì œ ì—°ë™**: í¬íŠ¸ì›(PortOne) ì—°ë™ - í”„ë¦¬ë¯¸ì—„ êµ¬ë… ì‹¤ê²°ì œ
2. **ëŒ€í˜• ì»´í¬ë„ŒíŠ¸ ë¶„ë¦¬**: AIChatPage(1408ì¤„), LostPage(1356ì¤„) ì„œë¸Œì»´í¬ë„ŒíŠ¸ ì¶”ì¶œ
3. **API URL ë§ˆì´ê·¸ë ˆì´ì…˜**: ê¸°ì¡´ í•˜ë“œì½”ë”© URL â†’ apiEndpoints.ts ìƒìˆ˜ ì‚¬ìš©ìœ¼ë¡œ ì ì§„ ì „í™˜

---

## ì£¼ì˜ì‚¬í•­

### í•˜ì§€ ë§ ê²ƒ
- ì»´í¬ë„ŒíŠ¸ì—ì„œ ìì²´ íƒ€ì… ì •ì˜ (types/index.ts ì‚¬ìš©)
- ì§ì ‘ì  ì£½ìŒ/ì‚¬ë§ í‘œí˜„ (ë¬´ì§€ê°œë‹¤ë¦¬, ì´ê³³ ì‚¬ìš©)
- ì´ëª¨ì§€ ë‚¨ìš© (ì„œë¹„ìŠ¤ í†¤ì•¤ë§¤ë„ˆ)
- console.log í”„ë¡œë•ì…˜ì— ë‚¨ê¸°ê¸°

### ë°˜ë“œì‹œ í•  ê²ƒ
- ì—ëŸ¬ ì²˜ë¦¬ + ì‚¬ìš©ì í”¼ë“œë°±
- ëª¨ë°”ì¼ ë°˜ì‘í˜• ê³ ë ¤
- ëª¨ë“œë³„ í…Œë§ˆ ìƒ‰ìƒ ì ìš©
- íƒ€ì… ì•ˆì „ì„± í™•ë³´

---

## ìì£¼ ë°œìƒí•˜ëŠ” ì‹¤ìˆ˜ & ë””ë²„ê¹…

### 1. ê°™ì€ ê¸°ëŠ¥ ë²„íŠ¼ ì—¬ëŸ¬ ê°œ â†’ ì¼ë¶€ë§Œ ìˆ˜ì •
**ë¬¸ì œ**: "ìƒˆ ë°˜ë ¤ë™ë¬¼" ë²„íŠ¼ì´ 3êµ°ë° ìˆëŠ”ë° 2êµ°ë°ë§Œ handleAddNewPetìœ¼ë¡œ ìˆ˜ì •
**í•´ê²°**: ìˆ˜ì • ì „ ë°˜ë“œì‹œ grepìœ¼ë¡œ ì „ì²´ ê²€ìƒ‰
```bash
grep -n "setIsPetModalOpen\|handleAddNewPet" src/components/pages/RecordPage.tsx
```

### 2. Dynamic Import ì‚¬ìš© ê¸ˆì§€
**ì›ì¹™**: ì¦‰ê°ì ì¸ ë°˜ì‘ì´ UXì— ë” ì¤‘ìš” (ìŠ¤í¬í‹°íŒŒì´ ì‚¬ë¡€)
**í•´ê²°**: ëª¨ë‹¬, ì»´í¬ë„ŒíŠ¸ëŠ” ì¼ë°˜ import ì‚¬ìš©. dynamic import ì‚¬ìš©í•˜ì§€ ì•ŠìŒ

### 3. ë°˜ì‘í˜• í…ìŠ¤íŠ¸ ì¤„ë°”ê¿ˆ
**ë¬¸ì œ**: "íŠ¹ë³„í•´ì§€ëŠ” ê³³"ì´ "íŠ¹" / "ë³„í•´ì§€ëŠ” ê³³"ìœ¼ë¡œ ëŠê¹€
**í•´ê²°**: ì§§ì€ í…ìŠ¤íŠ¸ë¡œ ë³€ê²½ ("íŠ¹ë³„í•œ ë§¤ì¼ì„ í•¨ê»˜")

### 4. Context ë¡œë”© íƒ€ì´ë°
**ë¬¸ì œ**: pets.lengthê°€ 0ìœ¼ë¡œ ë‚˜ì˜´ (ë°ì´í„° ë¡œë”© ì „)
**í•´ê²°**: isLoading ì²´í¬ í›„ ë Œë”ë§, useEffect ì˜ì¡´ì„± í™•ì¸

### 5. í”„ë¦¬ë¯¸ì—„ ëª¨ë‹¬ ì•ˆ ëœ¸
**ë¬¸ì œ**: ì œí•œ ì²´í¬ ë¡œì§ì´ ìˆëŠ” í•¨ìˆ˜ë¥¼ ì•ˆ ì“°ê³  ì§ì ‘ setModal(true) í˜¸ì¶œ
**í•´ê²°**: í•­ìƒ ë˜í¼ í•¨ìˆ˜ (handleAddNewPet) ì‚¬ìš©

---

## í”„ë¦¬ë¯¸ì—„/ë¬´ë£Œ íšŒì› ì œí•œ

| ê¸°ëŠ¥ | ë¬´ë£Œ | í”„ë¦¬ë¯¸ì—„ (ì›” 7,900ì›) |
|-----|-----|---------------------|
| AI í«í†¡ | í•˜ë£¨ 10íšŒ | ë¬´ì œí•œ |
| ë°˜ë ¤ë™ë¬¼ ë“±ë¡ | 1ë§ˆë¦¬ | ë¬´ì œí•œ |
| ì‚¬ì§„ ì €ì¥ | 100ì¥ | ë¬´ì œí•œ |

```typescript
// config/constants.ts - ì¤‘ì•™ ê´€ë¦¬
export const FREE_LIMITS = { PETS: 1, PHOTOS: 100, DAILY_CHAT: 10 };

// AuthContext.tsx - DB ê¸°ë°˜ í”„ë¦¬ë¯¸ì—„ ì²´í¬ (ì™„ë£Œ)
const isPremium = data?.is_premium && (!expiresAt || new Date(expiresAt) > new Date());
```

---

## ê´€ë¦¬ì ì‹œìŠ¤í…œ

```typescript
// types/index.ts
export const ADMIN_EMAILS = ["sharkwind1@gmail.com"];

export function isAdmin(email?: string | null): boolean {
    if (!email) return false;
    return ADMIN_EMAILS.includes(email);
}

// Layout.tsxì—ì„œ ê´€ë¦¬ì íƒ­ ì¡°ê±´ë¶€ í‘œì‹œ
{isAdmin(user?.email) && <AdminTab />}
```

---

## ìì£¼ ìˆ˜ì •í•˜ëŠ” íŒŒì¼

```
src/types/index.ts          # íƒ€ì… ì¶”ê°€/ìˆ˜ì •
src/contexts/PetContext.tsx # í« ë°ì´í„° ë¡œì§
src/app/api/chat/route.ts   # AI í”„ë¡¬í”„íŠ¸ ìˆ˜ì •
src/components/pages/*.tsx  # ê° í˜ì´ì§€ UI
```

---

## ê°œë°œì ì •ë³´

- **ì´ë¦„**: ì•ˆìŠ¹ë¹ˆ
- **ìƒí™©**: í’€ìŠ¤íƒ ë¶€íŠ¸ìº í”„ ìˆ˜ë£Œ ì˜ˆì • (2026ë…„ 3ì›”)
- **ëª©í‘œ**: MVP ëŸ°ì¹­ â†’ ì°½ì—…ì§€ì›ê¸ˆ ì‹ ì²­
